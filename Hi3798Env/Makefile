CC =/opt/HiSTBLinuxV100R005C00SPC041B020/tools/linux/toolchains/arm-histbv310-linux/bin/arm-histbv310-linux-gcc

TOP_DIR = ..
INSTALL_DIR = /hiEnv_obj
PROJECT = hiEnvBin
   
#CFLAGS = -O2 -Wall -g
CFLAGS = -Wall -mcpu=cortex-a53 -D_GNU_SOURCE -Wall -O2 -ffunction-sections -fdata-sections -Wl,--gc-sections -DCHIP_TYPE_hi3798mv200 -DCFG_HI_SDK_VERSION="HiSTBLinuxV100R005C00SPC041B020_20161028"  -DHI_DAC_CVBS=0 -DHI_SND_MUTECTL_GPIO= -DHI_SCI_CLK_MODE=0 -DHI_SCI_VCCEN_MODE=0 -DHI_SCI_RESET_MODE=0 -DHI_SCI_VCCEN_LEVEL=0 -DHI_SCI_DETECT_LEVEL=0 -DHI_TSI_port_NUMBER=4 -DHI_TSO_PORT_NUMBER=2 -DHI_IF0_TYPE=2 -DHI_IF0_BIT_SELECTOR=1 -DHI_TSI0_TYPE=2 -DHI_TSI0_CLK_PHASE_REVERSE=0 -DHI_TSI0_BIT_SELECTOR=0 -DHI_TSI1_TYPE=2 -DHI_TSI1_CLK_PHASE_REVERSE=0 -DHI_TSI1_BIT_SELECTOR=1 -DHI_TSI2_TYPE=2 -DHI_TSI2_CLK_PHASE_REVERSE=0 -DHI_TSI2_BIT_SELECTOR=1 -DHI_TSI3_TYPE=2 -DHI_TSI3_CLK_PHASE_REVERSE=0 -DHI_TSI3_BIT_SELECTOR=1 -DHI_TSI4_TYPE=2 -DHI_TSI4_CLK_PHASE_REVERSE=0 -DHI_TSI4_BIT_SELECTOR=1 -DHI_TSI5_TYPE=2 -DHI_TSI5_CLK_PHASE_REVERSE=0 -DHI_TSI5_BIT_SELECTOR=1 -DHI_TSO0_CLK=0 -DHI_TSO0_CLK_MODE=0 -DHI_TSO0_VALID_MODE=0 -DHI_TSO0_SERIAL=1 -DHI_TSO0_BIT_SELECTOR=0 -DHI_TSO1_CLK=0 -DHI_TSO1_CLK_MODE=0 -DHI_TSO1_VALID_MODE=0 -DHI_TSO1_SERIAL=1 -DHI_TSO1_BIT_SELECTOR=0 -DHI_TUNER_NUMBER=1 -DHI_TUNER0_ID=0 -DHI_TUNER_SIGNAL_TYPE=1 -DHI_TUNER_TYPE=17 -DHI_TUNER_DEV_ADDR=0xc0 -DHI_DEMOD_TYPE=257 -DHI_DEMOD_DEV_ADDR=0xa0 -DHI_DEMOD_TS_MODE=2 -DHI_DEMOD_USE_I2C -DHI_DEMOD_I2C_CHANNEL=2 -DHI_DEMOD_RESET_GPIO=0x4f -DHI_DEMUX_PORT=32 -DHI_DEMOD_REF_CLOCK=24000 -DHI_TUNER_MAX_LPF=34 -DHI_TUNER_I2C_CLOCK=400 -DHI_LNBCTRL_DEV_ADDR=0x0 -DHI_TER_DEMOD_REF_CLOCK=24000 -DHI_TER_TUNER_MAX_LPF=34 -DHI_TER_TUNER_I2C_CLOCK=400 -DHI_CAB_DEMOD_REF_CLOCK=24000 -DHI_CAB_TUNER_TS_SERIAL_PIN=0 -DHI_MULTIMODE_DEMOD_TS_COMB_FLAG=0 -DHI_MULTIMODE_DEMOD_TS_TAG0=0 -DHI_MULTIMODE_DEMOD_TS_TAG1=0 -DHI_MULTIMODE_DEMOD_TS_TAG2=0 -DHI_MULTIMODE_DEMOD_TS_TAG3=0 -DHI_TUNER1_ID=1 -DHI_TUNER1_SIGNAL_TYPE=2 -DHI_TUNER1_TYPE=10 -DHI_TUNER1_DEV_ADDR=0xc6 -DHI_DEMOD1_TYPE=264 -DHI_DEMOD1_DEV_ADDR=0xb4 -DHI_DEMOD1_TS_MODE=3 -DHI_DEMOD1_USE_I2C -DHI_DEMOD1_I2C_CHANNEL=2 -DHI_DEMOD1_RESET_GPIO=0x4f -DHI_DEMUX1_PORT=32 -DHI_DEMOD1_REF_CLOCK=24000 -DHI_TUNER1_MAX_LPF=34 -DHI_TUNER1_I2C_CLOCK=400 -DHI_TUNER1_RFAGC=0 -DHI_TUNER1_IQSPECTRUM=0 -DHI_TUNER1_TSCLK_POLAR=1 -DHI_TUNER1_TS_FORMAT=0 -DHI_TUNER1_TS_SERIAL_PIN=0 -DHI_TUNER1_DISEQCWAVE=0 -DHI_LNBCTRL1_DEV_TYPE=1 -DHI_LNBCTRL1_DEV_ADDR=0x0 -DHI_TER_DEMOD1_REF_CLOCK=24000 -DHI_TER_TUNER1_MAX_LPF=34 -DHI_TER_TUNER1_I2C_CLOCK=400 -DHI_CAB_DEMOD1_REF_CLOCK=24000 -DHI_MULTIMODE_DEMOD1_TS_COMB_FLAG=0 -DHI_MULTIMODE_DEMOD1_TS_TAG0=0 -DHI_MULTIMODE_DEMOD1_TS_TAG1=0 -DHI_MULTIMODE_DEMOD1_TS_TAG2=0 -DHI_MULTIMODE_DEMOD1_TS_TAG3=0 -DHI_TUNER2_ID=2 -DHI_TUNER2_SIGNAL_TYPE=4 -DHI_TUNER2_TYPE=24 -DHI_TUNER2_DEV_ADDR=0xc0 -DHI_DEMOD2_TYPE=268 -DHI_DEMOD2_DEV_ADDR=0xb8 -DHI_DEMOD2_TS_MODE=3 -DHI_DEMOD2_USE_I2C -DHI_DEMOD2_I2C_CHANNEL=2 -DHI_DEMOD2_RESET_GPIO=0x4f -DHI_DEMUX2_PORT=32 -DHI_DEMOD2_REF_CLOCK=24000 -DHI_TUNER2_MAX_LPF=34 -DHI_TUNER2_I2C_CLOCK=400 -DHI_LNBCTRL2_DEV_ADDR=0x0 -DHI_TER_DEMOD2_REF_CLOCK=24000 -DHI_TER_TUNER2_MAX_LPF=34 -DHI_TER_TUNER2_I2C_CLOCK=400 -DHI_TER_TUNER2_RFAGC=1 -DHI_TER_TUNER2_IQSPECTRUM=0 -DHI_TER_TUNER2_TSCLK_POLAR=1 -DHI_TER_TUNER2_TS_FORMAT=0 -DHI_TER_TUNER2_TS_SERIAL_PIN=0 -DHI_TER_TUNER2_TS_SYNC_HEAD=0 -DHI_TUNER3_ID=3 -DHI_TUNER3_SIGNAL_TYPE=1 -DHI_TUNER3_TYPE=4 -DHI_TUNER3_DEV_ADDR=0xc0 -DHI_DEMOD3_TYPE=256 -DHI_DEMOD3_DEV_ADDR=0xa0 -DHI_DEMOD3_TS_MODE=1 -DHI_DEMOD3_USE_I2C -DHI_DEMOD3_I2C_CHANNEL=5 -DHI_DEMOD3_RESET_GPIO=0x0 -DHI_DEMUX3_PORT=0 -DHI_DEMOD3_REF_CLOCK=24000 -DHI_TUNER3_MAX_LPF=34 -DHI_TUNER3_I2C_CLOCK=400 -DHI_LNBCTRL3_DEV_ADDR=0x0 -DHI_TER_DEMOD3_REF_CLOCK=24000 -DHI_TER_TUNER3_MAX_LPF=34 -DHI_TER_TUNER3_I2C_CLOCK=400 -DHI_ADVCA_FUNCTION_ 


####################  source  #########################
SOURCES  = user/main.c
SOURCES  += ini_file/ini_file.c

#hi_common_dev
SOURCES += common/hi_adp_demux.c
SOURCES += common/hi_adp_data.c
SOURCES += common/hi_adp_hdmi.c
SOURCES += common/hi_adp_mpi.c
SOURCES += common/hi_adp_search.c
SOURCES += common/hi_filter.c
SOURCES += common/hi_adp_tuner.c
SOURCES += common/hi_adp_pvr.c

#hi_env_device
SOURCES  += hi_fb/hi_fb.c
SOURCES  += hi_gpio/hi_gpio.c
SOURCES  += hi_player/hi_player.c
SOURCES  += hi_player/play_m3u9.c
SOURCES  += hi_osd/hi_osd.c
SOURCES  += hi_image/hi_image.c
SOURCES  += hi_main/hi_main.c
SOURCES  += hi_ipplay/hi_ipplay.c
SOURCES  += hi_pwm/hi_pwm.c
SOURCES  += uart485/uart485.c

#socket
SOURCES  += socket_unix/socket_unix.c

#################### include ######################
INCLUDS = -I$(shell pwd)/
INCLUDS +=-I$(shell pwd)/common/
INCLUDS +=-I$(shell pwd)/hi3798mv2dmo/include/
#INCLUDS +=-I/opt/HiSTBLinuxV100R005C00SPC041B020/sample/common
#INCLUDS +=-I/opt/HiSTBLinuxV100R005C00SPC041B020/out/hi3798mv200/hi3798mv2dmo/include 
INCLUDS +=-I$(shell pwd)/ini_file/
INCLUDS +=-I$(shell pwd)/msp_api/
INCLUDS +=-I$(shell pwd)/hi_fb/
INCLUDS +=-I$(shell pwd)/hi_gpio/
INCLUDS +=-I$(shell pwd)/hi_ipplay/
INCLUDS +=-I$(shell pwd)/hi_localplay/
INCLUDS +=-I$(shell pwd)/hi_osd/
INCLUDS +=-I$(shell pwd)/hi_scrolltext/ 
INCLUDS += -I$(shell pwd)/uart485/

#################### libs ######################
LIBS=$(SUBLIBS) -L/opt/HiSTBLinuxV100R005C00SPC041B020/out/hi3798mv200/hi3798mv2dmo/lib/share -L/opt/HiSTBLinuxV100R005C00SPC041B020/out/hi3798mv200/hi3798mv2dmo/lib/extern -L/opt/HiSTBLinuxV100R005C00SPC041B020/out/hi3798mv200/hi3798mv2dmo/lib/static -Wl,--start-group -lpthread -lrt -lm -ldl -lstdc++ -lhi_common -lpng -lhigo -lhigoadp -lfreetype -ljpeg -lhi_msp -lhi_resampler -lplayer -lhiplayer_utils -lsubdec -lz -lhi_subtitle -lhi_so -lhi_ttx -lhi_cc -lhi_vp -lrtp -leffect -Wl,--end-group

##make
SUBDIRS := $(shell find -type d)

$(shell for val in $(SUBDIRS);do \
mkdir -p $(TOP_DIR)$(INSTALL_DIR)/$${val}; \
done;)

OBJS = $(SOURCES:%.c=$(TOP_DIR)$(INSTALL_DIR)/%.o)

$(TOP_DIR)$(INSTALL_DIR)/%o:%c

$(TOP_DIR)$(INSTALL_DIR)/$(PROJECT):$(OBJS) $(HEADERS)
	$(CC) $(INCLUDS) -o $@ $^ $(LIBS)
	cp $(TOP_DIR)$(INSTALL_DIR)/$(PROJECT) /home/nfs_share/

$(TOP_DIR)$(INSTALL_DIR)/%.o:%.c $(HEADERS)
	$(CC) $(CFLAGS) $(INCLUDS) -c $< -o $@

############################################################
clean:
	-rm -rf $(TOP_DIR)$(INSTALL_DIR)

